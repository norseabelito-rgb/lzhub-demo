---
phase: 06-drive-integration
plan: 02
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - src/components/drive/drive-grid-item.tsx
  - src/components/drive/drive-grid.tsx
  - src/components/drive/drive-grid-skeleton.tsx
autonomous: true

must_haves:
  truths:
    - "Grid item shows thumbnail with selection checkbox"
    - "Grid displays responsive columns (3-6 based on screen)"
    - "Skeleton loading state matches grid layout"
  artifacts:
    - path: "src/components/drive/drive-grid-item.tsx"
      provides: "Individual thumbnail with checkbox overlay"
      exports: ["DriveGridItem"]
    - path: "src/components/drive/drive-grid.tsx"
      provides: "Responsive image grid with selection"
      exports: ["DriveGrid"]
    - path: "src/components/drive/drive-grid-skeleton.tsx"
      provides: "Loading skeleton for grid"
      exports: ["DriveGridSkeleton"]
  key_links:
    - from: "src/components/drive/drive-grid-item.tsx"
      to: "src/lib/drive/types.ts"
      via: "imports DriveFile type"
      pattern: "import.*DriveFile.*from"
    - from: "src/components/drive/drive-grid.tsx"
      to: "src/components/drive/drive-grid-item.tsx"
      via: "maps files to DriveGridItem components"
      pattern: "DriveGridItem"
---

<objective>
Create the image grid components for the Drive picker: individual grid items with selection checkboxes, the responsive grid container, and loading skeleton.

Purpose: Build the core visual component for browsing images. Users will see thumbnails in a grid and select them via checkbox overlays.
Output: Three components in src/components/drive/ for grid display and loading states.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/06-drive-integration/06-CONTEXT.md
@.planning/phases/06-drive-integration/06-RESEARCH.md
@src/lib/drive/types.ts
@src/components/ui/checkbox.tsx
@src/components/ui/skeleton.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create DriveGridItem with selection checkbox</name>
  <files>src/components/drive/drive-grid-item.tsx</files>
  <action>
Create the individual grid item component following Google Photos selection pattern:

1. Props interface DriveGridItemProps:
   - file: DriveFile
   - isSelected: boolean
   - onSelect: () => void
   - onPreview: () => void

2. Component structure:
   - Outer div: relative, aspect-square, cursor-pointer, rounded-lg, overflow-hidden, group class for hover states
   - Image: w-full h-full object-cover, loading="lazy", transition-transform, group-hover:scale-105
   - Checkbox container: absolute top-2 left-2 z-10
     - Opacity: always visible when selected, opacity-0 group-hover:opacity-100 otherwise
     - onClick with stopPropagation to prevent preview trigger
   - Selection ring: absolute inset-0 ring-2 ring-primary ring-inset when selected

3. Checkbox styling:
   - Use shadcn Checkbox component
   - Size: h-5 w-5
   - Border: border-2 border-white
   - Background: bg-black/50 for visibility on light images
   - Checked state: data-[state=checked]:bg-primary

4. Event handling:
   - Clicking image triggers onPreview
   - Clicking checkbox triggers onSelect (with stopPropagation)

5. Image error handling:
   - Add onError handler to show placeholder on failed load
   - Use a simple gray placeholder or broken image icon

IMPORTANT: Checkbox z-index must be higher than image hover effects to prevent disappearing on hover.
  </action>
  <verify>Component renders without errors when given mock DriveFile</verify>
  <done>Grid item displays thumbnail with checkbox overlay that appears on hover and stays visible when selected</done>
</task>

<task type="auto">
  <name>Task 2: Create responsive DriveGrid container</name>
  <files>src/components/drive/drive-grid.tsx</files>
  <action>
Create the grid container that displays multiple DriveGridItem components:

1. Props interface DriveGridProps:
   - files: DriveFile[]
   - selectedIds: Set<string>
   - onSelect: (fileId: string) => void
   - onPreview: (fileId: string) => void
   - emptyMessage?: string (default: "No images found")

2. Component structure:
   - If files.length === 0: Show empty state with message
   - Grid container with responsive columns:
     - grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2

3. Map files to DriveGridItem:
   - key={file.id}
   - isSelected={selectedIds.has(file.id)}
   - onSelect={() => onSelect(file.id)}
   - onPreview={() => onPreview(file.id)}

4. Empty state styling:
   - Centered text, muted color
   - py-12 for vertical spacing
   - Include folder icon from lucide-react

5. Consider adding a "Select All" toggle at the top (optional, can be added in picker integration).
  </action>
  <verify>Grid renders with responsive columns at different viewport widths</verify>
  <done>Grid displays images in responsive columns with selection state and empty state handling</done>
</task>

<task type="auto">
  <name>Task 3: Create DriveGridSkeleton for loading state</name>
  <files>src/components/drive/drive-grid-skeleton.tsx</files>
  <action>
Create skeleton loading component that matches grid layout:

1. Props interface:
   - count?: number (default: 12)

2. Component structure:
   - Same grid classes as DriveGrid: grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2
   - Map count items to Skeleton components
   - Each skeleton: aspect-square rounded-lg

3. Use shadcn Skeleton component for consistent styling

4. Export component for use during loading states
  </action>
  <verify>Skeleton renders 12 placeholder squares in responsive grid</verify>
  <done>Loading skeleton matches grid layout with proper aspect ratios</done>
</task>

</tasks>

<verification>
1. All three components exist in src/components/drive/
2. DriveGridItem shows checkbox on hover, stays visible when selected
3. Clicking checkbox selects without opening preview
4. Grid responds to viewport width (3-6 columns)
5. Skeleton matches grid layout
6. No TypeScript errors
</verification>

<success_criteria>
- Checkbox overlay visible on hover and when selected
- Selection ring appears around selected items
- Responsive grid: 3 columns mobile, up to 6 on large screens
- Empty state shows when no files
- Skeleton provides visual loading feedback
- Images use lazy loading for performance
</success_criteria>

<output>
After completion, create `.planning/phases/06-drive-integration/06-02-SUMMARY.md`
</output>
