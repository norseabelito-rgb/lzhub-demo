---
phase: 03-calendar
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/app/(dashboard)/calendar/page.tsx
  - src/app/(dashboard)/calendar/layout.tsx
  - src/components/calendar/day-view.tsx
  - src/components/calendar/week-view.tsx
  - src/components/calendar/month-view.tsx
  - src/components/calendar/calendar-header.tsx
  - src/components/calendar/reservation-card.tsx
  - src/components/layout/nav-items.ts
autonomous: true

must_haves:
  truths:
    - "User can view reservations in day view with 30-min time slots"
    - "User can view reservations in week view with day columns"
    - "User can view reservations in month view with date grid"
    - "User can switch between views and navigate dates"
    - "Reservation cards show name, time, and party size"
  artifacts:
    - path: "src/app/(dashboard)/calendar/page.tsx"
      provides: "Main calendar page with view switching"
      min_lines: 50
    - path: "src/components/calendar/day-view.tsx"
      provides: "Day view with 30-min time slots"
      min_lines: 80
    - path: "src/components/calendar/week-view.tsx"
      provides: "Week view with 7 day columns"
      min_lines: 80
    - path: "src/components/calendar/month-view.tsx"
      provides: "Month view grid"
      min_lines: 80
  key_links:
    - from: "src/components/calendar/day-view.tsx"
      to: "src/lib/calendar/reservation-store.ts"
      via: "useReservationStore hook"
      pattern: "useReservationStore"
    - from: "src/app/(dashboard)/calendar/page.tsx"
      to: "src/components/calendar/day-view.tsx"
      via: "conditional rendering"
      pattern: "DayView|WeekView|MonthView"
---

<objective>
Build the three calendar views (day, week, month) with navigation and view switching.

Purpose: Deliver CALR-02 (calendar views) - the core visual interface for viewing reservations. Users need to see their bookings at different time scales.
Output: Fully functional calendar page with three views, date navigation, and responsive design.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/03-calendar/03-01-SUMMARY.md (for types and store)
@src/lib/calendar/types.ts
@src/lib/calendar/reservation-store.ts
@src/components/checklists/checklist-card.tsx (reference for card pattern)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Calendar Page and Layout</name>
  <files>src/app/(dashboard)/calendar/page.tsx, src/app/(dashboard)/calendar/layout.tsx, src/components/calendar/calendar-header.tsx, src/components/layout/nav-items.ts</files>
  <action>
**layout.tsx** - Simple layout wrapper:
- Basic metadata for calendar section
- Children pass-through

**calendar-header.tsx** - Header component with:
- View switcher: Day | Week | Month (three buttons, active state)
- Date navigation: < Previous | Today | Next > buttons
- Current date display (format based on view: "Joi, 23 Ianuarie 2026" for day, "20-26 Ianuarie 2026" for week, "Ianuarie 2026" for month)
- Props: currentDate, view, onViewChange, onDateChange
- Use date-fns for formatting with Romanian locale

**page.tsx** - Main calendar page:
- State: currentView ('day' | 'week' | 'month'), currentDate
- Persist view preference to localStorage (remember last used per CONTEXT.md)
- Render CalendarHeader
- Conditionally render DayView, WeekView, or MonthView based on currentView
- Pass currentDate and reservations to view components

**nav-items.ts** - Add calendar to navigation:
- Add "Calendar" nav item with Calendar icon from lucide-react
- Route: /calendar
- Available to all roles (employee and manager)
  </action>
  <verify>Navigate to /calendar in browser, see header with view switcher</verify>
  <done>Calendar page accessible with view switching and date navigation</done>
</task>

<task type="auto">
  <name>Task 2: Create Day and Week Views</name>
  <files>src/components/calendar/day-view.tsx, src/components/calendar/week-view.tsx, src/components/calendar/reservation-card.tsx</files>
  <action>
**reservation-card.tsx** - Reusable card for displaying reservation:
- Props: reservation, compact (boolean for week/month view)
- Display: customerName, time, partySize, occasion badge if set
- Status indicator: colored dot (green=confirmed, gray=completed, red=cancelled/no_show)
- onClick handler (will be used later for opening reservation modal)
- Compact mode: just name and time, no badge
- Use Card component from ui/card

**day-view.tsx** - Detailed day view:
- Time column on left: 10:00 to 22:00 in 30-min intervals
- Each row = one time slot (48px height minimum)
- Reservations positioned in their time slots
- Multiple reservations at same time: stack horizontally
- Click on empty slot: trigger onSlotClick(date, time) callback
- Capacity indicator per slot (optional, subtle background color)
- Current time indicator: pink line across the view (only if viewing today)
- Responsive: full width on mobile

**week-view.tsx** - Week overview:
- 7 columns (Luni - Duminica), header row with day name + date
- Each day shows reservations as compact cards
- Click on day header: zoom to day view (per CONTEXT.md)
- Time range visible: simplified (morning/afternoon/evening sections)
- Today's column highlighted with subtle border
- Mobile: horizontal scroll or show 3 days at a time
  </action>
  <verify>`npm run build` passes, day view shows time slots, week shows 7 columns</verify>
  <done>Day and week views render reservations from store</done>
</task>

<task type="auto">
  <name>Task 3: Create Month View</name>
  <files>src/components/calendar/month-view.tsx</files>
  <action>
**month-view.tsx** - Monthly calendar grid:
- Standard calendar grid: 7 columns (L M M J V S D), 5-6 rows
- Each cell = one day
- Show day number in corner
- Show reservation count badge if >0 (e.g., "3 rezervari")
- Show first 2-3 reservations as mini cards (time + name only)
- "+N more" indicator if more than 3 reservations
- Click on day: zoom to day view
- Today highlighted with accent border
- Days outside current month: muted/grayed
- Responsive: smaller cells on mobile, hide mini cards and show only count

Build from scratch with date-fns (as per decision in CONTEXT.md - no external calendar library).

Use date-fns functions:
- startOfMonth, endOfMonth
- startOfWeek, endOfWeek (with { weekStartsOn: 1 } for Monday start)
- eachDayOfInterval
- isSameMonth, isSameDay, isToday
- format with { locale: ro } for Romanian
  </action>
  <verify>Month view shows correct days, today highlighted, click navigates to day</verify>
  <done>Month view provides overview with drill-down to day view</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npm run build` passes
2. /calendar route accessible and shows day view by default
3. View switcher works (Day/Week/Month)
4. Date navigation works (prev/next/today)
5. Reservations from mock data visible in all views
6. View preference persists across page refreshes
7. Click interactions work (day zoom in week/month)
</verification>

<success_criteria>
- CALR-02 satisfied: lunar/saptamanal/zilnic views implemented
- CALR-11 satisfied: interfata rapida si simpla (fast, minimal clicks)
- View switching instant (client-side)
- Date navigation intuitive
- Responsive on mobile
</success_criteria>

<output>
After completion, create `.planning/phases/03-calendar/03-02-SUMMARY.md`
</output>
